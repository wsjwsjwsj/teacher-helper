<!DOCTYPE html>
<html class="js cssanimations">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<title>学生信息</title>
	<link rel="stylesheet" href="amazeui.min.css">
	<link rel="stylesheet" href="pkunews.css">
	<script src="jquery.min.js"></script>
	<script src="amazeui.min.js"></script>
	<script src="handlebars.min.js"></script>
</head>
<body>
	<div class="pkunews_main">

		<div class="pkunews_head">
			<header data-am-widget="header" class="am-header am-header-red pkunews_head_block am-no-layout">
				<div style="text-align:center;color:#fff;font-family:Georgia;font-size:18px;font-weight:bold;">学生信息</div>
			</header>
		</div>
		<div class="pkunews_content" style="background-color:#fff;">
			<div class="am-panel-group">
				<div class="am-panel am-panel-default">
					<div class="am-panel-hd">&nbsp;&nbsp;<strong>选择学生</strong></div>    		
					<div class="am-panel-bd">
						<table class="am-table am-table-bordered am-table-striped am-table-centered am-table-compact">
							<tbody>
								<tr>
									<td rowspan="5"><strong>年级</strong></td>
									<td id="1" abbr="2002"  width="25%" onclick="changeAddrStyle(this)">2002</td>
									<td id="2" abbr="2003" width="25%" onclick="changeAddrStyle(this)">2003</td>
									<td id="3" abbr="2004" width="25%" onclick="changeAddrStyle(this)">2004</td>
								</tr>
								<tr>
									<td id="4" abbr="2005" width="25%" onclick="changeAddrStyle(this)">2005</td>
									<td id="5" abbr="2006" width="25%" onclick="changeAddrStyle(this)">2006</td>
									<td id="6" abbr="2007" width="25%" onclick="changeAddrStyle(this)">2007</td>
								</tr>
								<tr>
									<td id="7" abbr="2008" width="25%" onclick="changeAddrStyle(this)">2008</td>
									<td id="8" abbr="2009" width="25%" onclick="changeAddrStyle(this)">2009</td>
									<td id="9" abbr="2010" width="25%" onclick="changeAddrStyle(this)">2010</td>
								</tr>
								<tr>
									<td id="10" abbr="2011" width="25%" onclick="changeAddrStyle(this)" >2011</td>
									<td id="11" abbr="2012" width="25%" onclick="changeAddrStyle(this)" >2012</td>
									<td id="12" abbr="2013" width="25%" onclick="changeAddrStyle(this)">2013</td>
								</tr>
								<tr>
									<td id="13" abbr="2014" width="25%" onclick="changeAddrStyle(this)" >2014</td>
									<td id="14" abbr="2015" width="25%" onclick="changeAddrStyle(this)" >2015</td>
									<td id="15" abbr="2016" width="25%" onclick="changeAddrStyle(this)">2016</td>
								</tr>
						
								<tr>
									<td rowspan="1"><strong>是否立项</strong></td>
									<td id="17" abbr="已立项"  width="25%" onclick="changeAddrStyle(this)">是</td>
									<td id="18" abbr="未立项" width="25%" onclick="changeAddrStyle(this)">否</td>
									<td id="19" abbr="" width="25%" class="am-primary" onclick="changeAddrStyle(this)">全部</td>
								</tr>
								<tr>
									<td rowspan="1"><strong>是否结项</strong></td>
									<td id="21" abbr="已结项"  width="25%" onclick="changeAddrStyle(this)">是</td>
									<td id="22" abbr="未结项" width="25%" onclick="changeAddrStyle(this)">否</td>
									<td id="23" abbr="" width="25%" class="am-primary" onclick="changeAddrStyle(this)">全部</td>
								</tr>
								<tr>
									<td rowspan="1"><strong>是否开题</strong></td>
									<td id="25" abbr="已开题"  width="25%" onclick="changeAddrStyle(this)">是</td>
									<td id="26" abbr="未开题" width="25%" onclick="changeAddrStyle(this)">否</td>
									<td id="27" abbr="" width="25%" class="am-primary" onclick="changeAddrStyle(this)">全部</td>
								</tr>
								<tr>
									<td rowspan="1"><strong>论文是否通过</strong></td>
									<td id="29" abbr="论文已通过"  width="25%" onclick="changeAddrStyle(this)">是</td>
									<td id="30" abbr="论文未通过"  width="25%" onclick="changeAddrStyle(this)">否</td>
									<td id="31" abbr="" width="25%" class="am-primary" onclick="changeAddrStyle(this)">全部</td>
								</tr>
							</tbody>
						</table>
					</div>
				</div>
				<div class="am-panel am-panel-default">
					<div class="am-panel-hd">&nbsp;&nbsp;<strong><span id="title">全部学生</span></strong></div>  

					<div class="am-panel-bd" id="studentList">
						<table class="am-table">
							<thead>
				    			<tr>
				    				<th width="45%"><small>学号</small></th>
				    				<th width="45%"><small>姓名</small></th>
					           		<tbody id="studentInfo">
					                </tbody>
					       		</tr>
				    		</thead>
						</table>
					</div>

				</div>
                          
			</div>	
		</div>
	</div>

	<script type="text/javascript">
        var grade = [];
	    var lx = '';
		var jx = '';
		var kt = '';
		var lw = '';

		function changeAddrStyle(obj){
			var id = obj.id;
			if(id>0 && id<=15){
				if(!$(obj).hasClass("am-primary")){
					$(obj).addClass("am-primary"); 
					grade.push(obj.abbr);
		      	}else{  
		      		$(obj).removeClass("am-primary"); 
		      		grade=$.grep(grade,function(n, i){
                    	return n != obj.abbr;
					});       	   
		        }
			}else if(id>15 && id<=19){
				lx = obj.abbr;
				$("table tr td").each(function(index){
					if(index>15&&index<=19){
						if(index==parseInt(obj.id)){  
		            	    $(this).addClass("am-primary");  
		           	    }else{  
		               	    $(this).removeClass("am-primary");    
		                }
					}
				});
		    }else if(id>19 && id<=23){
		    	jx = obj.abbr;
 				$("table tr td").each(function(index){
					if(index>19&&index<=23){	
						if(index==parseInt(obj.id)){   
		             	   $(this).addClass("am-primary");  
		           	    }else{  
		               	    $(this).removeClass("am-primary");    
		           	    }
					}
				});
 		    }else if(id>23 && id<=27){
 		    	kt = obj.abbr;
				$("table tr td").each(function(index){
					if(index>23&&index<=27){						
						if(index==parseInt(obj.id)){   
		                	$(this).addClass("am-primary");  
		            	}else{  
		                	$(this).removeClass("am-primary");    
		            	}
					}
				});
			}else if(id>27 && id<=31){
				lw = obj.abbr;
				$("table tr td").each(function(index){
					if(index>27&&index<=31){
						if(index==parseInt(obj.id)){   
		                	$(this).addClass("am-primary");  
		            	}else{  
		                	$(this).removeClass("am-primary");    
		            	}
					}
	        	});
			}
			$("#title").html(grade.sort().join(",") + " " + lx + " " + jx + " " + kt + " " + lw + " 学生");
			retrSocores(grade, lx, jx, kt, lw);
	    };

		function retrSocores(grade, lx, jx, kt, lw) {
			var $studentList = $('#studentList');
			$studentList.hide();
		    var data = '<%- JSON.stringify(students)%>';
			var students = JSON.parse(data);
		    if(students){
				$studentList.show();             
				var sb = "";
				$.each(students, function(i, item) {
					if((grade.length == 0 || $.inArray(item.grade, grade) != -1)  && (!lx || item.lxConfirm == (lx == "已立项"?'1':null)) && (!jx || item.jxConfirm == (jx == "已结项"?'1':null)) && (!kt || item.ktconfirm == (kt == "已开题"?'1':null)) && (!lw || item.paperPass == (lw == "论文已通过"?'1':null))){
					sb += "<tr>";
					sb += "<td><a style=\"color:#000000;\" onclick=\"showDetail('" + item.stuid + "')\">" + item.stuid + "</a></td>";
					sb += "<td><a style=\"color:#000000;\" onclick=\"showDetail('" + item.stuid + "')\">" + item.name +"</a></td>";
					sb += "<td><a id=\"detailBtn_"+ item.stuid +"\" class=\"am-icon-chevron-down\" style=\"color:#8c0000;\" onclick=\"showDetail('" + item.stuid + "')\"></a></td>";
					sb += "</tr>";
					sb += "<tr>";
					sb += "<td colspan=4 id=\"xh_"+item.stuid+"\" style=\"display:none;\">";
					sb += "<div class=\"am-panel-bd\">";
					sb += "<div class=\"am-gallery-desc\"><label><small>性别</small></label>&nbsp;&nbsp;<span><small>"+item.gender + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>入学年月</small></label>&nbsp;&nbsp;<span><small>"+item.startyearmonth + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>年级</small></label>&nbsp;&nbsp;<span><small>"+item.grade + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>电话</small></label>&nbsp;&nbsp;<span><small>"+item.telephone + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>学生类型</small></label>&nbsp;&nbsp;<span><small>"+item.type_name + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>学位类型</small></label>&nbsp;&nbsp;<span><small>"+item.degree_type_name + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>位置</small></label>&nbsp;&nbsp;<span><small>"+item.location + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>专业</small></label>&nbsp;&nbsp;<span><small>"+item.major_name +"</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>研究方向</small></label>&nbsp;&nbsp;<span><small>"+item.researcharea +"</small></span></div>";	
					sb += "<div class=\"am-gallery-desc\"><label><small>是否立项</small></label>&nbsp;&nbsp;<span><small>"+ (item.lxConfirm == '1'?'是':'否') + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>是否结项</small></label>&nbsp;&nbsp;<span><small>"+ (item.jxConfirm == '1'?'是':'否') + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>是否开题</small></label>&nbsp;&nbsp;<span><small>"+ (item.ktconfirm == '1'?'是':'否') + "</small></span></div>";
					sb += "<div class=\"am-gallery-desc\"><label><small>论文是否通过</small></label>&nbsp;&nbsp;<span><small>"+ (item.paperPass == '1'?'是':'否') + "</small></span></div>";	
					sb += "</div>";			
					sb += "</td>";
					sb += "</tr>";
				        }
					});
				var $studentInfo = $('#studentInfo');
				$studentInfo.html(sb);
			}else{
				$studentList.hide();
				$('#title').html("错误");
			}

		};
		
		function showDetail(id){
			var $clickedBtn = $("#detailBtn_"+id);
			var $detailInfo = document.getElementById("xh_"+id);	
			if("none"==$detailInfo.style.display){
				$clickedBtn.attr("class","am-icon-chevron-up");
				$detailInfo.style.display="";
			}else{
				$clickedBtn.attr("class","am-icon-chevron-down");
				$detailInfo.style.display="none";
			}
		}
		
		$(function() {
			retrSocores(grade, lx, jx, kt, lw);
		});
	</script>
</body></html>